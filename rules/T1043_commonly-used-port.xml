<Sysmon schemaversion="4.30">
    <!--
        References:
		https://attack.mitre.org/techniques/T1043/
        List:
            Commonly used ports
        Todo:
            Folow the network, attackers can bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection:
            20: File Transfer Protocol (FTP) data transfer
            21: File Transfer Protocol (FTP) control (command)
            22: SSH(Secure Shell)
            23: Telnet protocol, monitor admin connections, insecure
            25: SMTP(Simple Mail Transfer Protocol) mail protocol port, insecure, used by threats
            53: DNS(Domain Name System) 
            80: HHTP(Hypertext Transfer Protocol)
            135: Remote Procedure Call
            143: IMAP mail protocol port, insecure, used by threats
            443: HTTPS(Hypertext Transfer Protocol Secure)
            3389: RDP(Remote Desktop protocol)
            5800: VNC protocol: Monitor admin connections, often insecure, using hard-coded admin password
            5900: VNC protocol Monitor admin connections, often insecure, using hard-coded admin password
            8080: Socks proxy port/HHTP(Hypertext Transfer Protocol)/Apache Tomcat...
            8008: HHTP(Hypertext Transfer Protocol)
            8443: port for httpsCA(https with Client Authentication SSL/TLS)
            And, try to reject false negative alert
        Testing:    
    -->

    <EventFiltering>
        <RuleGroup name="technique_id=T1043,is_alert=false" groupRelation="and">
            <NetworkConnect onmatch="include">
                <Rule groupRelation="or">
                    <DestinationPort condition="is">20</DestinationPort>
                    <DestinationPort condition="is">21</DestinationPort> 
                    <DestinationPort condition="is">22</DestinationPort> 
                    <DestinationPort condition="is">23</DestinationPort> 
                    <DestinationPort condition="is">25</DestinationPort> 
                    <DestinationPort condition="is">53</DestinationPort> 
                    <DestinationPort condition="is">80</DestinationPort> 
                    <DestinationPort condition="is">135</DestinationPort> 
                    <DestinationPort condition="is">143</DestinationPort> 
                    <DestinationPort condition="is">443</DestinationPort> 
                    <DestinationPort condition="is">3389</DestinationPort> 
                    <DestinationPort condition="is">5800</DestinationPort> 
                    <DestinationPort condition="is">5900</DestinationPort> 
                    <DestinationPort condition="is">8080</DestinationPort> 
                    <DestinationPort condition="is">8008</DestinationPort> 
                    <DestinationPort condition="is">8443</DestinationPort> 
                </Rule>
            </NetworkConnect>
        </RuleGroup>
    </EventFiltering>
</Sysmon>
